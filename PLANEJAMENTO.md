# Sistema de Quadro de Horários Inteligente - Plano de Funcionalidades

## Visão Geral

Este plano descreve um **sistema de quadro de horários inteligente** integrado ao EduPrime, um ERP escolar modular desenvolvido em Ionic Framework. O foco é atender escolas da educação básica brasileira (Educação Infantil, Ensino Fundamental e Ensino Médio), especialmente em **redes municipais** (prefeituras). O sistema será **mobile-first**, ou seja, projetado primeiramente para uso em smartphones (utilizando Ionic para garantir responsividade), com uma interface amigável em telas pequenas. A meta é agilizar a elaboração de horários escolares, incorporando automação e inteligência artificial para otimizar a alocação de aulas, professores e salas, respeitando as particularidades das escolas municipais. A seguir, detalhamos as funcionalidades, fluxos de uso por perfil (secretaria escolar e professor), sugestões de UI móvel e o uso de IA (via OpenAI SDK) em cada etapa do processo.

## Estrutura de Funcionalidades

### Criação Rápida e Visual de Horários

* **Interface de Montagem Intuitiva:** O sistema permite criar quadros de horários por turma/série de forma **rápida e visual**. Os administradores (secretaria escolar) podem **montar ou editar a grade arrastando e soltando** blocos de aula em uma grade de horários. Cada bloco representa uma aula (disciplina + professor) e pode ser movido entre diferentes horários ou dias com gestos simples (toque e arraste) adequados a telas de toque.
* **Edição Direta na Grade:** A montagem pode ser feita diretamente na visualização estilo calendário ou Kanban (ver detalhes abaixo em *Visualizações Interativas*). Por exemplo, o usuário seleciona uma turma e vê uma grade vazia da semana; então pode adicionar aulas em cada período clicando em um slot vazio e escolhendo disciplina/professor, ou duplicando padrões de dias. A interface destaca visualmente conflitos ou restrições violadas em tempo real (por exemplo, se dois blocos de aula conflitam no mesmo horário). Cores e rótulos ajudam na identificação (cada disciplina ou série pode ter uma cor, e nomes de professores aparecem abreviados para caber na tela pequena).
* **Templates e Reutilização:** Para agilizar, o sistema pode oferecer modelos base de horários (por exemplo, copiar a estrutura do ano anterior ou de outra turma semelhante) e então permitir ajustes finos. Também será possível cadastrar **regras padrão** (e.g. educação infantil sempre tem intervalo às 10h) para já pré-preencher certos horários.
* **Suporte a Múltiplos Turnos:** O sistema contempla escolas com mais de um turno (ex.: manhã, tarde e noite), permitindo montar horários separados por turno quando aplicável. A secretaria pode alternar o turno que está editando e o sistema garantirá que um mesmo professor não seja alocado em dois turnos simultâneos, considerando também tempo de deslocamento se necessário.
* **Validação Imediata:** Conforme o quadro é montado manualmente, regras básicas são aplicadas instantaneamente: um professor não pode ter duas aulas ao mesmo tempo, uma turma não pode ter duas disciplinas no mesmo horário, e salas especiais (laboratórios, ginásio) não podem ser dupla-booking. Qualquer conflito é sinalizado automaticamente na interface, antes mesmo de salvar.

### Sugestões Automáticas de Horários Otimizados (IA)

* **Geração Automática via IA:** O sistema oferece a opção de **gerar automaticamente um quadro de horários otimizado** utilizando IA através do SDK da OpenAI. A secretaria informa os dados necessários (turmas, disciplinas, carga horária de cada disciplina, professores disponíveis e suas disponibilidades, salas especiais, etc.), e aciona a geração automática. O modelo de IA então produz uma sugestão de grade horária completa, levando em conta múltiplos critérios de otimização.
* **Agrupamento de Aulas por Professor:** Um dos critérios-chave programados na IA é **agrupar aulas de um mesmo professor de forma sequencial** quando possível. Ou seja, se um professor leciona múltiplas aulas em um dia, a IA tende a colocá-las em seguida, evitando que ele tenha intervalos longos ou precise retornar em outro horário desnecessariamente. Essa prática evita **“janelas”** no horário do professor, aumentando a eficiência do tempo na escola. (Por exemplo, se o professor João tem 4 aulas em uma semana, o algoritmo buscará alocar essas aulas em blocos contíguos em dias específicos, ao invés de uma aula isolada por dia).
* **Minimização da Presença Física:** Alinhado ao ponto anterior, a IA busca **minimizar o tempo ocioso e dias de presença física do professor na escola**, evitando espaços vazios entre aulas. Se um professor leciona apenas 3 aulas semanais, idealmente elas ficariam concentradas em 1 ou 2 dias, ao invés de espalhadas em 3 dias diferentes. Assim, reduz-se deslocamentos e custos, o que é especialmente útil em contextos municipais onde professores podem lecionar em mais de uma escola.
* **Respeito à Disponibilidade e Preferências:** A geração automática respeita **disponibilidade de cada professor e sala** informada previamente. Antes de gerar, o sistema coleta ou importa do EduPrime os horários indisponíveis de cada professor (ex: horário de coordenação, dia de folga, etc.) e marca quais salas estão disponíveis em quais períodos. A IA usa essas restrições como limites rígidos – não alocará um professor ou sala em horário não disponível. (Os dados de disponibilidade podem ser cadastrados diretamente pelos professores no próprio sistema, evitando trocas manuais de mensagens para coletar essas informações.)
* **Outros Critérios de Otimização:** A IA pode considerar ainda outros fatores: distribuição equilibrada de aulas (evitar que uma turma tenha todas as aulas de matemática seguidas no mesmo dia, por exemplo), cumprimento da carga horária semanal de cada disciplina, e até preferências individuais (um professor preferir não ter primeira aula na segunda-feira, por exemplo). Tais preferências podem ser inseridas como *pesos* ou *sugestões suaves* – a IA tenta atendê-las, mas não as violações não geram conflito duro.
* **Múltiplas Sugestões e Refinamento:** O usuário poderá solicitar **múltiplas sugestões** de horário. A IA pode gerar, por exemplo, duas ou três versões de horário com diferentes enfoques (uma maximizando blocos duplos de aula, outra maximizando distribuição homogênea ao longo da semana, etc.). A secretaria pode comparar as versões, possivelmente com ajuda de indicadores (quantas janelas de professor cada versão tem, quantos dias um professor precisa ir à escola, etc.). Eles podem então aprovar a versão mais adequada ou fazer ajustes manuais em cima da sugestão escolhida. Em caso de ajuste manual, o sistema continua alertando para conflitos e pode chamar a IA novamente para **ajustar pontualmente** (por exemplo: “realocar a aula X para resolver conflito Y”).

### Permitir Solicitação de Trocas de Horário (Professor)

* **Funcionalidade de Solicitar Troca:** Após os horários serem publicados, professores têm acesso (via aplicativo móvel) à sua grade pessoal e podem **solicitar trocas de aula/horário** de forma simples e visual. A interface para o professor listará suas aulas com detalhes (disciplina, turma, horário, sala) e oferecerá a opção “Solicitar Troca” em cada aula.
* **Seleção do Novo Horário/Destino:** Ao acionar uma solicitação, o professor pode indicar *qual aula ou horário* ele deseja trocar. Existem duas modalidades de solicitação:

  1. **Troca Direta com Colega:** O professor seleciona a aula de um colega específico para propor uma troca (por exemplo, trocar sua aula de Matemática de terça 3ª aula pela aula de Ciências do professor X na quarta 2ª aula). A interface exibirá apenas aulas compatíveis para troca (mesma duração, mesmas turmas livres naquele horário, etc.) para evitar propostas inválidas.
  2. **Pedido de Alteração Aberta:** O professor indica que deseja alterar sua aula de um determinado horário, sem apontar um colega específico – por exemplo “gostaria de liberar minha última aula de sexta-feira”. Essa solicitação aberta é enviada à secretaria ou a um painel geral onde outros professores/adm podem visualizar e se oferecer para trocar.
* **Interface Simples e Visual:** No mobile, essa operação ocorre através de toques: o professor toca na aula que quer trocar, e então vê uma lista ou calendário destacando possíveis horários alternativos ou aulas de outros professores elegíveis. Poderá haver um visual de calendário marcando onde há **espaços disponíveis** ou **outras aulas** com as quais a troca pode ocorrer. Com dois toques o professor seleciona a alternativa desejada e confirma o pedido de troca.
* **Notificação e Fluxo de Aprovação:** Uma vez solicitada, a troca entra em um fluxo de aprovação. O colega envolvido na troca (no caso de troca direta) recebe uma notificação no app para **aceitar ou recusar**. Se for uma solicitação aberta, todos os professores que poderiam assumir aquele horário ou trocar verão um aviso e podem se candidatar. A secretaria escolar também recebe notificações de solicitações de troca pendentes. Dependendo da política da escola, a troca pode necessitar aprovação final da secretaria/direção (por exemplo, para garantir que não prejudique a sequência pedagógica). Quando aprovada, o sistema atualiza automaticamente o quadro de horários de ambos os professores/turmas envolvidas e notifica os afetados.

### Negociação de Trocas de Aulas com Suporte de IA

* **Plataforma de Negociação:** O sistema inclui um **módulo de negociação de horários** onde trocas podem ser gerenciadas de forma colaborativa. Em casos mais complexos, professores podem discutir trocas via comentários ou chat dentro do app, mas a inovação aqui é que a **IA auxilia ativamente sugerindo cenários de troca ideais**.
* **Sugestões Inteligentes de Troca:** Ao selecionar a opção de trocar uma aula, a **IA avalia automaticamente** a disponibilidade e horários de outros professores para sugerir a melhor solução. Por exemplo, se o professor A quer trocar sua aula de quarta-feira com alguém, e o professor B quer trocar uma de quinta, o sistema pode sugerir um swap mútuo que satisfaça ambos. Ou a IA pode identificar que o professor C não tem aulas em certo horário e poderia cobrir o horário desejado, rearranjando outras aulas para fechar o buraco. Essas sugestões levam em conta que todas as **restrições e pré-requisitos** continuem sendo atendidos durante a troca – o objetivo é encontrar cenários onde ambos os professores saiam beneficiados sem gerar conflitos para nenhuma turma ou sala.
* **Exemplo de Funcionamento:** Suponha que o Professor Carlos tenha uma aula na 1ª aula de segunda-feira que gostaria de trocar porque tem um compromisso médico periódico. Ele inicia uma solicitação de troca para essa aula. O sistema (via IA) busca entre os demais professores alguém que tenha aula em outro dia/horário equivalente e que, ao trocar, não cause conflito. Digamos que a Professora Ana tem uma aula na 1ª aula de quarta-feira e estaria disposta a trocar. A IA sugere essa troca direta Carlos <-> Ana, pois ambos manteriam suas cargas e turmas cobertas, apenas permutando dias. O sistema mostra: “Sugestão: trocar aula de Segunda 1ª (Carlos - Matemática 9ºA) com Quarta 1ª (Ana - Ciências 9ºA)”. Cada professor pode então aceitar. Se ninguém específico for encontrado de imediato, a IA pode sugerir **alternativas** como envolver um terceiro professor (troca tripla) ou ajustar uma aula para um horário vago, sempre buscando minimizar alterações totais.
* **Mediação e Aprovação:** A ferramenta de negociação mostra visualmente os **cenários sugeridos**. Os professores podem ajustar ou negociar detalhes (por exemplo, propor outra opção caso a sugerida não seja ideal). A IA pode recalcular uma nova sugestão se uma proposta for recusada. Uma vez que os envolvidos concordam com um cenário de troca, ele é enviado para registro na secretaria. A secretaria pode ter um painel consolidado dessas negociações, com opção de intervir se necessário (como vetar trocas que desrespeitem alguma regra pedagógica não codificada). Em geral, o processo é **descentralizado e ágil**, com a IA servindo como um “árbitro inteligente” que encontra a solução ótima para todos.

### Resolução de Conflitos de Grade com IA

* **Detecção Automática de Conflitos:** Ao montar o horário (seja manualmente ou via IA), o sistema identifica **conflitos de grade** em tempo real. Conflitos típicos incluem: um professor alocado em dois lugares ao mesmo tempo, uma turma com duas aulas simultâneas, ou tentativa de usar a mesma sala para duas turmas no mesmo horário. Esses conflitos são destacados na interface (por exemplo, com cor vermelha ou ícones de alerta no bloco correspondente).
* **Sugestões para Resolver Conflitos:** Quando um conflito é detectado, o usuário (secretário) pode acionar o botão **“Sugerir Solução”**. Nesse momento, a integração com a IA analisa o conflito específico e **propõe ajustes** para resolvê-lo. Por exemplo, se o Professor José ficou marcado em duas turmas na terça-feira 3ª aula, a IA pode sugerir mover uma dessas aulas para um horário alternativo em que José e a turma estejam livres (respeitando todas restrições). Ou, se não houver slot livre direto, sugerir uma sequência de trocas: mover aula X para outro horário e, em cascata, ajustar a aula Y daquele horário para outro, até eliminar o choque. A solução sugerida sempre **mantém as restrições previamente cadastradas** e evita criar novos conflitos.
* **Aplicação Semi-Automática:** O sistema pode permitir aplicar a sugestão com um clique, já reordenando as aulas conforme indicado pela IA. Alternativamente, o secretário pode revisar e ajustar a sugestão manualmente. Em casos de múltiplas opções, a IA pode listar duas ou três maneiras de resolver (ex.: "Opção A: trocar a aula de lugar com outra no horário X", "Opção B: trocar salas entre duas turmas"). O secretário então escolhe a melhor.
* **IA Preventiva:** Além de resolver conflitos existentes, a IA pode atuar de forma **preventiva**. Durante a geração automática inicial, os algoritmos de IA já evitam inserir conflitos duplos – por exemplo, sistemas inteligentes como o Cronos já conseguem **gerar horários completos sem nenhum choque de professores ou aulas**. Assim, boa parte dos conflitos jamais chega a ocorrer. Os poucos que surgirem (geralmente decorrentes de ajustes manuais posteriores ou mudanças de última hora) são resolvidos rapidamente com essa assistência inteligente.
* **Conflitos de Disponibilidade:** Se houver um conflito de disponibilidade (por exemplo, um professor alocado em um horário que depois declarou não poder), o sistema marca como conflito de disponibilidade. Nesses casos, a IA também ajuda sugerindo **remanejamento daquela aula** para outro horário em que o professor esteja disponível, ou talvez **sugerindo um professor substituto** para aquele horário, caso a troca de docente seja possível e permitida. Isso adiciona resiliência ao horário diante de ausências ou mudanças.

### Visualizações Interativas da Grade Horária (Kanban, Calendário, Blocos)

Para atender diferentes preferências e tornar a experiência mais amigável em telas pequenas, o sistema oferece **múltiplas opções de visualização** do quadro de horários, todas interativas:

* **Visão Kanban (Quadro de Cartões):** Nesta opção, cada dia da semana pode ser uma coluna (na orientação horizontal), e os horários são representados por cartões empilhados na coluna do respectivo dia. Cada cartão mostra a aula (disciplina e professor). O usuário pode **arrastar cartões** de uma coluna para outra ou reordenar dentro da mesma coluna, alterando o dia/horário daquela aula. Em smartphones, essa visão pode ser implementada com scroll horizontal (para navegar pelos dias) e vertical (dentro de cada dia para ver todos os horários). É útil para ver de relance a distribuição semanal e realizar realocações rápidas entre dias – por exemplo, mover um cartão de terça para quinta arrastando-o.
* **Visão Calendário Semanal:** Apresenta uma grade tradicional com dias da semana no topo e horários na lateral, semelhante a um calendário escolar convencional. Em telas pequenas, pode aparecer como uma agenda semanal listando as aulas cronologicamente por dia (ou permitindo zoom e scroll para ver o grid completo). Cada aula é um bloco na posição correspondente. Essa visualização é intuitiva para conferir conflitos e observar a sequência temporal. O usuário também pode fazer ajustes nela (por exemplo, tocar e segurar em um bloco de aula para então arrastar para outro horário, ou abrir um menu de opções para trocar aquela aula).
* **Visão de Blocos Arrastáveis:** Semelhante ao calendário, mas focada na edição: apresenta todas as aulas como **blocos móveis** em uma lista ou grid. Pode haver, por exemplo, uma lista de “aulas não alocadas” ou “a ajustar” e a grade vazia ao lado; o usuário então arrasta os blocos para slots livres. Essa visão estilo *drag-and-drop* é benéfica no início do planejamento, para distribuir as aulas em branco. No mobile, se o espaço for limitado para arrastar, a interface pode permitir o usuário **tocar no bloco e depois no slot de destino** como alternativa ao gesto de arraste puro.
* **Detalhes e Alternância de Visões:** Em todas as visões, é possível tocar em um elemento (card ou bloco de aula) para ver detalhes completos (turma, horário, sala, carga horária restante, etc.). O sistema permite alternar entre visões sem perder as modificações feitas, de forma que o secretário pode, por exemplo, montar parte do horário no Kanban e depois alternar para o modo Calendário para verificá-lo cronologicamente. Essa flexibilidade aumenta a usabilidade, pois cada usuário pode adotar a visualização com que se sente mais confortável.
* **Indicadores Visuais:** As visualizações incorporam **códigos de cor e ícones** para facilitar a leitura rápida. Por exemplo, cada disciplina pode ter uma cor fixa (Matemática em azul, Português em verde), cada professor pode ter um avatar ou iniciais exibidas no cartão, e conflitos aparecem com destaque (cartão com borda vermelha, ou ícone de alerta). Sugestões da IA podem ser marcadas de forma sutil, por exemplo, um cartão com borda tracejada ou cor diferenciada sugerindo “este bloco pode ser trocado para otimizar”.
* **Modo de Visualização do Professor:** Vale notar que os professores, ao acessarem seus horários, verão uma **versão simplificada** dessas visualizações – por exemplo, apenas sua própria agenda semanal (pode ser em formato lista ou calendário diário). Eles não precisam do Kanban de toda a escola, mas sim de uma visualização filtrada por professor/disciplina, focada em consulta e em interações de troca de aulas específicas.

### Integração com Dados do EduPrime

* **Base Única de Dados:** O sistema aproveita os dados já existentes no EduPrime, evitando retrabalho e inconsistências. Assim, turmas, séries, disciplinas, professores, alunos e calendários escolares já cadastrados no EduPrime são automaticamente disponibilizados no módulo de horários. Por exemplo, ao criar um quadro de horários para 2025, o usuário escolhe dentre as turmas registradas no EduPrime e associa as disciplinas conforme a grade curricular existente.
* **Sincronização Bidirecional:** Qualquer atualização relevante no ERP principal reflete no módulo de horários. Se um novo professor for contratado e adicionado no EduPrime, ele aparece na lista de professores disponíveis para alocação. Se uma turma mudar de nome ou uma disciplina for alterada, a informação sincroniza. Inversamente, após finalizar o quadro de horários, este pode ser **publicado de volta no EduPrime** – por exemplo, para alimentar outros módulos (frequência de alunos, diário de classe eletrônico, comunicações aos pais sobre horários de aula, etc.).
* **Autenticação Unificada:** Professores e secretários usam suas **credenciais do EduPrime** para acessar o sistema de horários. Isso simplifica o acesso (Single Sign-On) e permite controle de permissões unificado. A secretaria escolar terá privilégios de administrador da grade, enquanto cada professor terá acesso limitado para visualizar sua agenda e solicitar trocas, mas não editar a grade global.
* **Disponibilidade de Professores e Salas:** O módulo de horários puxa do EduPrime (ou coleta no próprio sistema, conforme configurado) as **disponibilidades e restrições**. Como mencionado, cada professor pode indicar seus horários livres ou impedimentos diretamente no sistema, que ficam salvos e integrados ao perfil dele. Salas especiais podem ser cadastradas no EduPrime (ex.: laboratório de informática, quadra de esportes) com capacidade e horários de uso, e essas informações são consideradas ao montar o quadro.
* **Integração com Calendário Escolar:** Feriados, recessos e eventos escolares cadastrados no EduPrime também são levados em conta. O sistema de horários pode bloquear datas ou marcar semanas atípicas (ex.: semana de prova tem horários diferenciados) de acordo com o calendário geral da escola. Isso garante que as sugestões da IA ou montagens manuais não coloquem aulas em dias não letivos, por exemplo.
* **Exportação e Relatórios:** Além da integração em tempo real, o sistema permite **exportar o quadro de horários** em formatos úteis, como PDF ou planilhas, para atender demandas burocráticas das prefeituras (por exemplo, enviar a grade oficial para a secretaria municipal de educação) ou simplesmente para impressão e afixação na escola. Essa exportação já utiliza os dados consistentes do EduPrime, assegurando que não haja divergência entre o digital e o impresso.

## Fluxos de Interação por Tipo de Usuário

### Fluxo para Secretaria Escolar (Administradores)

1. **Preparação dos Dados:** No início do ano ou período letivo, a secretaria escolar acessa o módulo de horários. Ele verifica se todas as **turmas, disciplinas e professores** do período estão atualizados (os dados já vêm do EduPrime). Também garante que as **disponibilidades/horários de trabalho de cada professor** estejam cadastradas – podendo enviar lembretes aos professores para atualizarem seus horários não disponíveis, ou inserindo manualmente conforme acordado. Salas especiais e turnos são conferidos (ex.: marcar que laboratório de ciências só comporta 1 turma por horário).
2. **Criação ou Geração da Grade:** A partir do zero ou de um modelo pré-existente, o secretário inicia a **montagem do quadro de horários**. Aqui ele tem duas opções não excludentes: montar manualmente usando a interface visual (arrastando aulas para slots), **ou utilizar a Sugestão Automática da IA**. Muitas vezes, ele opta por gerar uma **proposta inicial via IA** para ganhar tempo. O sistema então coleta as informações necessárias e chama o serviço do OpenAI para gerar a sugestão de horário otimizado. Em poucos instantes, uma grade completa é apresentada na tela.
3. **Revisão e Ajustes:** O secretário analisa a sugestão de horário gerada. Ele pode navegar pelos dias e verificar se tudo faz sentido pedagogicamente (sequência de aulas, distribuição de disciplinas etc.). Se identificar algo que deseje mudar – por exemplo, duas aulas de matemática seguidas todos os dias pode não ser ideal – ele pode **editar manualmente** arrastando aquela aula para outro dia/horário. Ao fazer isso, o sistema avisa se algum conflito é introduzido. O secretário pode também pedir à IA uma **nova sugestão refinada**: por exemplo, selecionar a turma 9ºA e solicitar “redistribuir aulas de Matemática ao longo da semana”. A IA então recalcula apenas a parte solicitada.
4. **Resolução de Conflitos:** Se algum conflito ou inconsistência permanecer (marcado em vermelho no quadro), o secretário utiliza a funcionalidade de **Resolver Conflito**. O sistema apresenta as sugestões de ajuste de IA para cada problema identificado. Por exemplo, “Conflito: Professor Maria com duas aulas na Terça 2ª. Sugestão: mover aula de Ciências 8ºB para Quinta 3ª.” O secretário avalia e, se concordar, aplica a sugestão com um clique. Em casos onde a sugestão não atenda, ele pode manualmente resolver (ex.: mudar a professora daquela aula, ou horário diferente) e o sistema verificará novamente conflitos.
5. **Validação e Publicação:** Com o quadro de horários completo e livre de conflitos, o secretário finaliza a grade. Ele então **publica** o horário: isso notifica todos os professores (e possivelmente responsáveis, via outros canais do EduPrime) de que o horário oficial está disponível. A publicação pode envolver gerar um PDF consolidado para registro oficial e também ativar a visualização do horário nos aplicativos dos professores e portais dos alunos.
6. **Ajustes Contínuos e Trocas:** Ao longo do semestre, a secretaria acompanha solicitações de mudança. Pelo painel administrativo, ela visualiza todas as **solicitações de troca** feitas pelos professores. Para cada solicitação:

   * Se for uma **troca direta entre dois professores** já acordada (o outro professor aceitou via app), a secretaria apenas recebe um resumo (ex: “Troca aprovada: Matemática 9ºA (João) <-> Geografia 9ºA (Maria) na terça-feira”) e pode optar por intervir se vir problema, ou simplesmente arquivar ciente.
   * Se for uma **solicitação pendente** (aguardando alguém aceitar), a secretaria pode facilitar indicando possíveis professores para atender o pedido. O sistema IA também pode alertar a secretaria caso detecte uma solução (ex: “Sugestão: A professora Ana poderia cobrir essa aula, pois está livre nesse horário”). A secretaria então pode contatar Ana ou aprovar automaticamente a alteração envolvendo Ana.
   * Se for uma situação excepcional (por ex., professor precisa se ausentar por várias semanas), a secretaria pode usar o mesmo módulo de negociação para **reorganizar temporariamente** o quadro: solicitar à IA opções de remanejamento de aulas ou substituições de professor, garantindo a continuidade das aulas.
7. **Comunicação e Histórico:** Em todos os casos, a secretaria tem controle final. O sistema registra um **histórico de alterações** no quadro (quem trocou o quê e quando), útil para auditoria e planejamento futuro. A secretaria pode gerar relatórios dessas mudanças, e o sistema pode usar esses dados para aprender padrões (por ex., se certas aulas são frequentemente trocadas, talvez no próximo ano já seja melhor alocá-las em outro horário inicialmente).
8. **Final de Período:** Ao término do bimestre/semestre/ano, a secretaria pode arquivar o quadro de horários antigo e iniciar um novo ciclo duplicando ou ajustando o anterior. Todo o processo se repete com as vantagens da IA e das funcionalidades visuais, economizando tempo valioso da gestão escolar.

### Fluxo para Professores

1. **Acesso ao Horário:** Cada professor acessa o aplicativo (ou portal) EduPrime e visualiza sua **agenda de aulas pessoal**. Em uma interface móvel simples, ele vê as aulas que leciona distribuídas pelos dias da semana, com informações como turma, horário e sala. Essa visualização permite alternar entre formato de lista (por dia) ou um mini calendário semanal, de acordo com a preferência.
2. **Conferência e Notificações:** Assim que o horário é publicado pela secretaria, o professor recebe uma **notificação** (no app e/ou e-mail) informando que seu horário está disponível. Ele confere se todas as suas turmas e aulas estão corretas. Caso note algum problema (por exemplo, um horário incompatível com alguma atividade ou um erro de atribuição), ele pode entrar em contato com a secretaria ou usar as ferramentas de solicitação de ajuste.
3. **Indicação de Disponibilidade:** Se o professor não o fez anteriormente, ele pode atualizar suas **preferências e disponibilidade** diretamente pelo app. Por exemplo, se toda quarta tarde ele tem reunião de formação e não pode dar aulas, ele marca esse período como indisponível (isso ficará para referência em futuras alterações ou próximos períodos letivos). Essa etapa geralmente ocorre no início do processo, mas o professor pode ajustar se algo mudar em sua rotina.
4. **Solicitar Troca de Aula:** Quando um professor precisa trocar um horário de aula – seja por um compromisso pessoal isolado, seja por preferir uma distribuição diferente – ele usa a funcionalidade de **Solicitar Troca**. Pelo app, ele seleciona a aula em questão e então ou escolhe um novo horário desejado (dentre os disponíveis ou aulas de colegas elegíveis) ou deixa em aberto para sugestão. Ele pode, por exemplo, selecionar “Trocar minha aula de História de sexta-feira última aula” e ver uma lista de colegas que têm aula em outras turmas naquela mesma sexta ou quinta e que poderiam trocar. Ele escolhe a melhor opção e envia a solicitação.
5. **Receber Sugestões da IA:** O professor também se beneficia das sugestões inteligentes. Suponha que ele queira muito trocar uma aula de dia, mas não tenha ninguém específico em mente. O sistema pode mostrar “IA Sugere: trocar com a aula de Geografia na quarta-feira, professora Marina, pois ela solicitou trocar aquela aula dela”. Essas sugestões facilitam o professor a encontrar a solução sem precisar tentar manualmente vários colegas.
6. **Negociar e Confirmar Troca:** Se a troca envolve outro professor, o colega receberá uma notificação solicitando aprovação. O professor que iniciou pode acompanhar o status no app (por ex.: “Aguardando resposta do Prof. X”). Assim que o outro aceita, ambos recebem confirmação e seus horários são atualizados automaticamente. Se o colega recusar ou não responder, o solicitante pode buscar outra opção ou cancelar o pedido. Em trocas mais complexas, ambos professores podem conversar via um chat interno para acertar detalhes, mas geralmente a interface estruturada já supre a necessidade.
7. **Atualização do Horário:** Uma vez efetivada uma troca ou mudança aprovada, o professor verá sua agenda atualizada imediatamente no app. O sistema destaca quais aulas foram alteradas recentemente (por exemplo, com uma cor diferente ou um ícone de "atualizado"), para chamar atenção. Isso evita confusão e permite que ele se programe de acordo com a mudança.
8. **Feedback e Ajustes Futuros:** Os professores podem dar **feedback** sobre o horário através do app – por exemplo, avaliando se a distribuição de aulas ficou boa ou se houve algum problema recorrente (muitas trocas necessárias, etc.). Esses feedbacks podem ser usados pela coordenação e pelo sistema para aprimorar os critérios no futuro. Além disso, no caso de alguma mudança estrutural (como um novo projeto na escola que altere horários), o professor pode ser envolvido numa consulta via app, antes da secretaria refazer o horário com a IA, garantindo assim que as sugestões automáticas reflitam o contexto real.

## Interface Intuitiva e Adaptada a Telas Pequenas (Mobile-First Design)

* **Design Responsivo (Ionic):** Aproveitando o framework Ionic, o aplicativo oferece um design totalmente responsivo, priorizando o uso em **smartphones** sem perder funcionalidade em tablets ou desktops. Os componentes adaptam-se dinamicamente: em telas pequenas, elementos se reorganizam em colunas únicas com scroll vertical, menus viram ícones dobráveis e componentes complexos (como a grade semanal) podem ser visualizados em modo simplificado.
* **Navegação Simplificada:** A interface mobile-first utiliza **menus claros e acessíveis**. As principais funções (como “Montar Horário”, “Sugestões IA”, “Minhas Aulas”, “Solicitar Troca”) estão disponíveis através de uma barra de menu inferior ou menu hambúrguer, garantindo que com poucos toques o usuário chegue onde precisa. Dentro de cada tela, usa-se títulos e subtítulos para contexto e **agrupamento de ações**. Por exemplo, na tela de montagem de horários, há seções dobráveis para cada turma ou dia da semana, de modo que o usuário possa focar em uma de cada vez e expandir/ocultar conforme necessário – isso evita excesso de informação de uma só vez na tela pequena.
* **Elementos Otimizados para Toque:** Todos os botões e cards seguem o guideline de tamanho mínimo confortável (em torno de 40px de altura/largura) para toque com os dedos, evitando frustração do usuário em acertar pequenos alvos. Gestos como **arrastar** e **deslizar** foram implementados pensando no mobile: por exemplo, para mover uma aula, o usuário toca e segura um card por meio segundo para ativar o modo de arraste, então desliza para o local desejado. Caso arrastar não seja preciso, o usuário pode tocar em um item e escolher “mover para…” para realocar via seleção de alvo, uma opção útil para acessibilidade.
* **Feedback Visual e Usabilidade:** A interface fornece respostas instantâneas às ações do usuário, crucial em mobile. Ao arrastar um bloco para um novo horário, ele destaca o slot de destino com cor de realce. Se a ação causar conflito, o aplicativo vibra levemente e mostra um alerta na tela (“Conflito: sala indisponível”), em tempo real. Ícones e cores são usados consistentemente: por exemplo, um ícone de **duas setas trocando** representa a função de troca de aulas, um ícone de **varinha mágica** ou **lâmpada** representa uma sugestão de IA disponível. Dicas de ferramenta (tooltips) de curto texto podem aparecer após um toque longo em algum elemento para explicar sua função, beneficiando usuários menos experientes.
* **Layouts para Visualização da Grade:** No smartphone, a visualização do calendário semanal pode ser exibida como um **scroll contínuo** por dia: o usuário rola verticalmente para ver as aulas daquele dia e desliza horizontalmente para mudar de dia. A visão Kanban, conforme citado, desloca horizontalmente para dias e verticalmente para listar aulas – nesse caso, pode haver uma aba por turno (manhã/tarde) para não sobrecarregar em uma tela só. Já a visão de blocos (drag-and-drop) pode abrir em tela cheia um quadro por vez (ex.: quadro da turma 7ºA), com opções de passar para a próxima turma com um gesto de deslizar lateral. Isso tudo mantendo textos legíveis e possibilidade de zoom nos casos necessários.
* **Sugestões de UI Específicas:** Algumas ideias de componentes amigáveis:

  * Uso de **cards colapsáveis** para representar cada turma ou professor na visão administrativa, expandindo para mostrar os horários.
  * **Lista de conflitos/sugestões** acessível via ícone de alerta no topo: toca-se no ícone e expande-se uma lista de “Itens a resolver”, cada um com botão para ver detalhe ou aplicar solução IA.
  * **Calendário interativo** para seleção de datas excepcionais: por exemplo, se precisar ajustar um dia específico, o usuário escolhe a data em um mini calendário e vê apenas aquele dia.
  * **Modal de confirmação** sempre que uma troca ou ajuste importante for feito, com resumo da alteração e opção de desfazer imediata caso o usuário se arrependa.
  * Paleta de cores personalizável: a prefeitura pode ajustar as cores atribuídas às disciplinas ou séries, garantindo que as escolas sigam um padrão visual que lhes agrade (mas sempre com contraste suficiente para acessibilidade).
* **Desempenho e Offline:** Considerando cenários de conectividade instável em escolas, o app será **otimizado para desempenho**, carregando dados de forma incremental e armazenando em cache local as informações básicas (por exemplo, o horário vigente de cada professor) para consulta rápida mesmo offline. Qualquer ação feita offline (como um professor solicitar troca) fica em fila e sincroniza quando a conexão retornar, com indicação clara do status. Isso é importante para contextos municipais onde nem todas as escolas têm Wi-Fi de qualidade em 100% do tempo.
* **Testes de Usabilidade:** O design mobile-first será iterativamente testado com usuários reais (secretários e professores de escolas municipais) para garantir que as telas pequenas não sejam um impeditivo. A linguagem da interface será simples e em português claro, evitando jargões técnicos. Instruções breves podem guiar nas primeiras utilizações, tornando a curva de aprendizado curta. A ideia é que mesmo profissionais de educação com menor familiaridade tecnológica consigam utilizar o sistema sem dificuldades após um breve treinamento.

## Uso da Inteligência Artificial (OpenAI) em Cada Etapa

A IA, acessada via **OpenAI SDK**, está profundamente integrada nas etapas-chave do sistema para oferecer sugestões inteligentes e automação. A seguir descrevemos como os modelos de IA (como GPT-4) são utilizados em cada caso de uso:

* **Geração Automática do Quadro de Horários:** Quando o administrador opta por gerar o horário automaticamente, o sistema compila todos os dados relevantes (lista de aulas, professores, restrições, critérios de otimização) e envia para um serviço baseado em IA. Esse serviço pode usar um modelo de linguagem avançado para **resolver o problema de alocação** e retornar um possível quadro de horários completo em formato estruturado. Internamente, o prompt passado para a IA descreve todas as turmas e aulas necessárias e impõe as condições (professor X só pode seg-ta manhã, sala Y apenas 3 vezes por semana, etc.). O modelo, então, calcula/estima uma solução que atenda a tudo e devolve uma proposta que o sistema traduz em eventos na grade. Essa abordagem permite levar em conta múltiplos fatores simultaneamente, encontrando arranjos que talvez não fossem óbvios manualmente, garantindo um resultado **sem conflitos e otimizado** em segundos. Claro, a solução sugerida é validada pelo sistema antes de apresentar (verificando se realmente não há choque de recursos).
* **Sugestões Personalizadas e Otimização Contínua:** A IA não atua apenas na geração inicial. Sempre que o usuário solicita, ela pode oferecer **sugestões contextuais**. Por exemplo, ao perceber que um professor ficou com apenas uma aula em um dia isolado, o sistema pode automaticamente sugerir: “Que tal mover esta aula para ficar junto com as outras do professor na quarta-feira?” – essa recomendação é criada via IA analisando o contexto do horário atual e comparando com as boas práticas (como evitar aulas isoladas). Do mesmo modo, se uma turma tiver um dia muito carregado e outro muito leve, a IA pode identificar esse desbalanço e sugerir distribuir melhor. Essas sugestões usam o modelo para *propor* melhorias que atendam aos objetivos dados (reduzir janelas, equilibrar cargas, etc.), servindo como um assistente proativo de planejamento.
* **Resolução de Conflitos Automatizada:** Conforme descrito, a IA é usada para **resolver conflitos de horários** de forma eficiente. Tecnicamente, quando um conflito é detectado, o sistema formula para o modelo uma descrição do problema (ex: “Professor Carlos está atribuído a duas turmas no mesmo horário. Turma A tem X outro horário livre; Turma B tem Y outro horário livre; Constrangimentos: ...”) e pergunta por possíveis soluções. O modelo então retorna uma ou mais maneiras de corrigir, respeitando as restrições. Isso poupa o administrador de ter que testar manualmente várias combinações. A IA funciona como um “consultor” rápido, encontrando uma solução viável dentro do espaço de possibilidades. Novamente, qualquer sugestão é validada pelo sistema antes de aplicar. Esse uso de IA acelerou muito a etapa de ajustes finais, garantindo um quadro final **coeso e sem conflitos**.
* **Otimização e Sugestão de Trocas de Aulas:** Na funcionalidade de negociação de trocas, a IA entra em ação para **encontrar correspondências** entre pedidos de professores. Quando um professor envia um pedido (por ex., “preciso trocar minha aula de terça tarde”), o sistema pergunta à IA quais seriam as melhores opções. O modelo considera todos os professores disponíveis naquele mesmo horário ou em horários permutáveis e avalia cenários de troca. Ele pode devolver uma lista do tipo: “Opção 1: trocar com Prof. Ana (ela assume terça tarde, você assume aula dela quarta manhã); Opção 2: trocar com Prof. B etc.” juntamente com explicações se necessário. Assim, o professor ou secretário não precisa manualmente checar agenda de cada colega – a IA faz essa **busca inteligente** no lugar deles. Essa otimização de trocas também verifica automaticamente se a troca proposta não viola restrições (mesma turma não ter dois professores no mesmo dia indevidamente, carga horária semanal ficando correta, etc.).
* **Assistente Virtual (Chatbot) para Agendamento:** Como complemento, podemos oferecer um **assistente virtual conversacional** dentro do sistema, alimentado pelo mesmo motor de IA. Esse assistente permite que usuários façam perguntas ou comandos em linguagem natural, como: “Gerar horário para turma 8ºB considerando que professor João só pode segunda e quarta” ou “Quais são os conflitos atuais no horário do 1ºAno A?” e obter respostas imediatas. Embora não seja indispensável, essa interface traz inovação e facilidade para usuários avançados ou que prefiram texto. O OpenAI GPT-4, por exemplo, pode interpretar a solicitação e acionar as funções internas correspondentes (via *plugins* ou *tools*) para cumprir o pedido do usuário, tornando a experiência mais natural.
* **Melhoria Contínua via IA:** Com o uso frequente, o sistema acumula dados de horários e preferências. Poderá ser treinado (ou utilizar *fine-tuning*) em cima das soluções já validadas para **melhorar ainda mais as sugestões futuras**. A IA aprenderá, por exemplo, padrões específicos das escolas municipais (como qual disciplina costuma ser primeira do dia, ou que tipos de trocas são mais comuns) e poderá incorporar esses aprendizados nas próximas gerações automáticas. Isso significa que, com o tempo, as sugestões ficam cada vez mais alinhadas às necessidades reais das instituições usuárias.
* **Considerações de Segurança e Controle:** Importante salientar que, embora a IA ofereça poderosas recomendações, o **controle final é sempre humano**. Todas as ações automáticas requerem confirmação (especialmente as que afetam o horário após publicado). Além disso, o uso do OpenAI SDK será feito de forma segura, garantindo confidencialidade dos dados (nenhuma informação sensível de alunos ou professores será enviada sem criptografia e acordo de privacidade). A IA será usada como um apoio à decisão e automação, mas políticas definidas pela secretaria (por exemplo, limites de quantas trocas um professor pode fazer, ou horários que nunca devem ter determinada aula) sempre prevalecem – o sistema pode até instruir a IA a respeitar essas políticas nos prompts. Em suma, a IA atua como um **parceiro inteligente** que potencializa a eficiência do sistema: acelera a criação do horário, encontra soluções para impasses e torna a gestão do quadro de aulas mais dinâmica e adaptada às demandas do dia a dia escolar.
